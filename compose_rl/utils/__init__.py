# Copyright 2024 MosaicML ComposeRL authors
# SPDX-License-Identifier: Apache-2.0

from compose_rl.utils.utils import (
    add_right_padding,
    approx_kl,
    batch_process_fine_granularities,
    clear_mb_load_balancing_loss,
    compute_advantages,
    dist_compute_masked_mean_and_var,
    extract_packed_chosen_rejected,
    flatten,
    flip_pad_token_usage_for_generate,
    flip_pad_token_usage_in_ffn,
    format_reward_input,
    get_batch_logp,
    get_batched_generated_values,
    get_decoded_sequence,
    get_entropies,
    get_log_probs,
    get_log_probs_from_logits,
    get_mb_load_balancing_loss,
    get_remote_name,
    get_training_dataloader_state_dict,
    make_action_mask,
    make_padded_tensor,
    mask_eos,
    masked_mean,
    masked_normalize,
    masked_sum,
    masked_var,
    masked_whiten,
    process_fine_granularities,
    remove_left_padding,
    rescale,
    scatter_gather_rewards,
    split_text_to_sentences,
    split_text_to_subsentences,
    switch_left_to_right_padding,
)
from compose_rl.utils.vllm_utils import (
    broadcast_to_vllm,
    create_vllm_engines,
    init_process_group,
)

__all__ = [
    'get_mb_load_balancing_loss',
    'clear_mb_load_balancing_loss',
    'approx_kl',
    'get_log_probs',
    'get_entropies',
    'switch_left_to_right_padding',
    'remove_left_padding',
    'add_right_padding',
    'get_batched_generated_values',
    'masked_sum',
    'masked_mean',
    'masked_var',
    'masked_normalize',
    'masked_whiten',
    'compute_advantages',
    'dist_compute_masked_mean_and_var',
    'get_training_dataloader_state_dict',
    'mask_eos',
    'get_decoded_sequence',
    'split_text_to_sentences',
    'split_text_to_subsentences',
    'rescale',
    'format_reward_input',
    'process_fine_granularities',
    'batch_process_fine_granularities',
    'scatter_gather_rewards',
    'flip_pad_token_usage_for_generate',
    'flip_pad_token_usage_in_ffn',
    'get_remote_name',
    'get_log_probs_from_logits',
    'extract_packed_chosen_rejected',
    'make_padded_tensor',
    'get_batch_logp',
    'make_action_mask',
    'create_vllm_engines',
    'init_process_group',
    'broadcast_to_vllm',
    'flatten',
]
